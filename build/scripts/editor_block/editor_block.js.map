{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/scripts/cwpc-hierarchical-term-selector.js","webpack:///./src/scripts/editor_block.js","webpack:///./src/scripts/editor_block_data.js","webpack:///./src/scripts/terms.js","webpack:///external [\"wp\",\"apiFetch\"]","webpack:///external [\"wp\",\"components\"]","webpack:///external [\"wp\",\"compose\"]","webpack:///external [\"wp\",\"data\"]","webpack:///external [\"wp\",\"element\"]","webpack:///external [\"wp\",\"i18n\"]","webpack:///external [\"wp\",\"url\"]","webpack:///external \"lodash\""],"names":["DEFAULT_QUERY","per_page","orderby","order","_fields","MIN_TERMS_COUNT_FOR_FILTER","CWPCHierarchicalTermSelector","Component","constructor","arguments","findTerm","bind","onChange","onChangeFormName","onChangeFormParent","onAddTerm","onToggleForm","setFilterValue","sortBySelected","state","loading","availableTermsTree","availableTerms","adding","formName","formParent","showForm","filterValue","filteredTermsTree","termId","onUpdateTerms","terms","taxonomy","props","hasTerm","indexOf","newTerms","without","rest_base","onClear","event","newValue","target","value","trim","setState","newParent","parent","name","find","term","parseInt","toLowerCase","preventDefault","slug","existingTerm","some","id","addRequest","apiFetch","path","method","data","undefined","findOrCreatePromise","catch","error","errorCode","code","addQueryArgs","search","then","searchResult","Promise","reject","availableTerm","newAvailableTerms","termAddedMessage","sprintf","_x","get","__","speak","buildTermsTree","xhr","statusText","componentDidMount","fetchTerms","componentWillUnmount","invoke","fetchRequest","componentDidUpdate","prevProps","prioritizedTermsTree","prioritize","termsTree","treeHasSelection","termTree","children","anyChildIsSelected","map","filter","child","length","termOrChildIsSelected","termA","termB","termASelected","termBSelected","sort","getFilterMatcher","getResultCount","count","i","resultCount","resultsFoundMessage","_n","debouncedSpeak","matchTermsForFilter","originalTerm","renderTerms","renderedTerms","activeCssClass","controlID","isPrimary","unescapeString","togglePrimary","CWPC_Core","render","instanceId","hasCreateAction","hasAssignAction","klass","hierarchical","labelWithFallback","labelProperty","fallbackIsCategory","fallbackIsNotCategory","newTermButtonLabel","newTermLabel","parentSelectLabel","noParentOption","newTermSubmitLabel","inputId","filterInputId","filterLabel","groupLabel","showFilter","noneSelected","noneLabel","radio_no_term","label","termID","current","wp","select","getEditedPostAttribute","metaKey","toString","togglePrimaryDispatch","primaryFound","nonPrimary","compose","withSelect","getCurrentPost","getTaxonomy","withDispatch","dispatch","restBase","editPost","meta","withSpokenMessages","withInstanceId","cwpcHierarchicalTermSelectorOverride","OriginalComponent","targetTaxonomy","hooks","addFilter","flatTerms","flatTermsWithParentAndChildren","termsByParent","groupBy","null","fillWithChildren"],"mappings":"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","file":"editor_block.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/scripts/editor_block.js\");\n","/**\n * Creates a new Hierarchical Term Selector\n * since the Wordpress does not expose this original class,\n * a lot of heavy lifting is done here\n * @see\thttps://github.com/WordPress/gutenberg/blob/trunk/packages/editor/src/components/post-taxonomies/hierarchical-term-selector.js\n */\n\n/**\n * External dependencies\n */\nimport {\n\tget,\n\tunescape as unescapeString,\n\twithout,\n\tfind,\n\tsome,\n\tinvoke,\n} from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __, _x, _n, sprintf } from '@wordpress/i18n';\nimport { Component } from '@wordpress/element';\nimport {\n\tRadioControl,\n\tTreeSelect,\n\twithSpokenMessages,\n\tButton, CheckboxControl,\n} from '@wordpress/components';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { withInstanceId, compose } from '@wordpress/compose';\nimport apiFetch from '@wordpress/api-fetch';\nimport { addQueryArgs } from '@wordpress/url';\n\n/**\n * Internal dependencies\n */\nimport { buildTermsTree } from './terms';\nimport { CWPC_Core } from './editor_block_data';\n\n/**\n * Module Constants\n */\nconst DEFAULT_QUERY = {\n\tper_page: -1,\n\torderby: 'name',\n\torder: 'asc',\n\t_fields: 'id,name,parent',\n};\nconst MIN_TERMS_COUNT_FOR_FILTER = 8;\n\nclass CWPCHierarchicalTermSelector extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.findTerm = this.findTerm.bind( this );\n\t\tthis.onChange = this.onChange.bind( this );\n\t\tthis.onChangeFormName = this.onChangeFormName.bind( this );\n\t\tthis.onChangeFormParent = this.onChangeFormParent.bind( this );\n\t\tthis.onAddTerm = this.onAddTerm.bind( this );\n\t\tthis.onToggleForm = this.onToggleForm.bind( this );\n\t\tthis.setFilterValue = this.setFilterValue.bind( this );\n\t\tthis.sortBySelected = this.sortBySelected.bind( this );\n\t\tthis.state = {\n\t\t\tloading: true,\n\t\t\tavailableTermsTree: [],\n\t\t\tavailableTerms: [],\n\t\t\tadding: false,\n\t\t\tformName: '',\n\t\t\tformParent: '',\n\t\t\tshowForm: false,\n\t\t\tfilterValue: '',\n\t\t\tfilteredTermsTree: [],\n\t\t};\n\t}\n\n\tonChange( termId ) {\n\t\tconst { onUpdateTerms, terms = [], taxonomy } = this.props;\n\t\tconst hasTerm = terms.indexOf( termId ) !== -1;\n\t\tconst newTerms = hasTerm\n\t\t\t? without( terms, termId )\n\t\t\t: [ ...terms, termId ];\n\t\tonUpdateTerms( newTerms, taxonomy.rest_base );\n\t}\n\n\tonClear() { // @helgatheviking props @tomjn\n\t\tconst { onUpdateTerms, taxonomy } = this.props;\n\t\tonUpdateTerms( [], taxonomy.rest_base );\n\t}\n\n\tonChangeFormName( event ) {\n\t\tconst newValue =\n\t\t\tevent.target.value.trim() === '' ? '' : event.target.value;\n\t\tthis.setState( { formName: newValue } );\n\t}\n\n\tonChangeFormParent( newParent ) {\n\t\tthis.setState( { formParent: newParent } );\n\t}\n\n\tonToggleForm() {\n\t\tthis.setState( ( state ) => ( {\n\t\t\tshowForm: ! state.showForm,\n\t\t} ) );\n\t}\n\n\tfindTerm( terms, parent, name ) {\n\t\treturn find( terms, ( term ) => {\n\t\t\treturn (\n\t\t\t\t( ( ! term.parent && ! parent ) ||\n\t\t\t\t\tparseInt( term.parent ) === parseInt( parent ) ) &&\n\t\t\t\tterm.name.toLowerCase() === name.toLowerCase()\n\t\t\t);\n\t\t} );\n\t}\n\n\tonAddTerm( event ) {\n\t\tevent.preventDefault();\n\t\tconst { onUpdateTerms, taxonomy, terms, slug } = this.props;\n\t\tconst { formName, formParent, adding, availableTerms } = this.state;\n\t\tif ( formName === '' || adding ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// check if the term we are adding already exists\n\t\tconst existingTerm = this.findTerm(\n\t\t\tavailableTerms,\n\t\t\tformParent,\n\t\t\tformName\n\t\t);\n\t\tif ( existingTerm ) {\n\t\t\t// if the term we are adding exists but is not selected select it\n\t\t\tif ( ! some( terms, ( term ) => term === existingTerm.id ) ) {\n\t\t\t\tonUpdateTerms(\n\t\t\t\t\t[ ...terms, existingTerm.id ],\n\t\t\t\t\ttaxonomy.rest_base\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.setState( {\n\t\t\t\tformName: '',\n\t\t\t\tformParent: '',\n\t\t\t} );\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setState( {\n\t\t\tadding: true,\n\t\t} );\n\t\tthis.addRequest = apiFetch( {\n\t\t\tpath: `/wp/v2/${ taxonomy.rest_base }`,\n\t\t\tmethod: 'POST',\n\t\t\tdata: {\n\t\t\t\tname: formName,\n\t\t\t\tparent: formParent ? formParent : undefined,\n\t\t\t},\n\t\t} );\n\t\t// Tries to create a term or fetch it if it already exists\n\t\tconst findOrCreatePromise = this.addRequest.catch( ( error ) => {\n\t\t\tconst errorCode = error.code;\n\t\t\tif ( errorCode === 'term_exists' ) {\n\t\t\t\t// search the new category created since last fetch\n\t\t\t\tthis.addRequest = apiFetch( {\n\t\t\t\t\tpath: addQueryArgs( `/wp/v2/${ taxonomy.rest_base }`, {\n\t\t\t\t\t\t...DEFAULT_QUERY,\n\t\t\t\t\t\tparent: formParent || 0,\n\t\t\t\t\t\tsearch: formName,\n\t\t\t\t\t} ),\n\t\t\t\t} );\n\t\t\t\treturn this.addRequest.then( ( searchResult ) => {\n\t\t\t\t\treturn this.findTerm( searchResult, formParent, formName );\n\t\t\t\t} );\n\t\t\t}\n\t\t\treturn Promise.reject( error );\n\t\t} );\n\t\tfindOrCreatePromise.then(\n\t\t\t( term ) => {\n\t\t\t\tconst hasTerm = !! find(\n\t\t\t\t\tthis.state.availableTerms,\n\t\t\t\t\t( availableTerm ) => availableTerm.id === term.id\n\t\t\t\t);\n\t\t\t\tconst newAvailableTerms = hasTerm\n\t\t\t\t\t? this.state.availableTerms\n\t\t\t\t\t: [ term, ...this.state.availableTerms ];\n\t\t\t\tconst termAddedMessage = sprintf(\n\t\t\t\t\t/* translators: %s: taxonomy name */\n\t\t\t\t\t_x( '%s added', 'term' ),\n\t\t\t\t\tget(\n\t\t\t\t\t\tthis.props.taxonomy,\n\t\t\t\t\t\t[ 'labels', 'singular_name' ],\n\t\t\t\t\t\tslug === 'category' ? __( 'Category' ) : __( 'Term' )\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t\tthis.props.speak( termAddedMessage, 'assertive' );\n\t\t\t\tthis.addRequest = null;\n\t\t\t\tthis.setState( {\n\t\t\t\t\tadding: false,\n\t\t\t\t\tformName: '',\n\t\t\t\t\tformParent: '',\n\t\t\t\t\tavailableTerms: newAvailableTerms,\n\t\t\t\t\tavailableTermsTree: this.sortBySelected(\n\t\t\t\t\t\tbuildTermsTree( newAvailableTerms )\n\t\t\t\t\t),\n\t\t\t\t} );\n\t\t\t\tonUpdateTerms( [ ...terms, term.id ], taxonomy.rest_base );\n\t\t\t},\n\t\t\t( xhr ) => {\n\t\t\t\tif ( xhr.statusText === 'abort' ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.addRequest = null;\n\t\t\t\tthis.setState( {\n\t\t\t\t\tadding: false,\n\t\t\t\t} );\n\t\t\t}\n\t\t);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.fetchTerms();\n\t}\n\n\tcomponentWillUnmount() {\n\t\tinvoke( this.fetchRequest, [ 'abort' ] );\n\t\tinvoke( this.addRequest, [ 'abort' ] );\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tif ( this.props.taxonomy !== prevProps.taxonomy ) {\n\t\t\tthis.fetchTerms();\n\t\t}\n\t}\n\n\tfetchTerms() {\n\t\tconst { taxonomy } = this.props;\n\t\tif ( ! taxonomy ) {\n\t\t\treturn;\n\t\t}\n\t\tthis.fetchRequest = apiFetch( {\n\t\t\tpath: addQueryArgs(\n\t\t\t\t`/wp/v2/${ taxonomy.rest_base }`,\n\t\t\t\tDEFAULT_QUERY\n\t\t\t),\n\t\t} );\n\t\tthis.fetchRequest.then(\n\t\t\t( terms ) => {\n\t\t\t\t// resolve\n\n\t\t\t\tconst prioritizedTermsTree = this.prioritize(terms);\n\n\t\t\t\tconst availableTermsTree = this.sortBySelected(\n\t\t\t\t\tbuildTermsTree( prioritizedTermsTree )\n\t\t\t\t);\n\n\t\t\t\tthis.fetchRequest = null;\n\t\t\t\tthis.setState( {\n\t\t\t\t\tloading: false,\n\t\t\t\t\tavailableTermsTree,\n\t\t\t\t\tavailableTerms: terms,\n\t\t\t\t} );\n\t\t\t},\n\t\t\t( xhr ) => {\n\t\t\t\t// reject\n\t\t\t\tif ( xhr.statusText === 'abort' ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.fetchRequest = null;\n\t\t\t\tthis.setState( {\n\t\t\t\t\tloading: false,\n\t\t\t\t} );\n\t\t\t}\n\t\t);\n\t}\n\n\tsortBySelected( termsTree ) {\n\t\tconst { terms } = this.props;\n\t\tconst treeHasSelection = ( termTree ) => {\n\t\t\tif ( terms.indexOf( termTree.id ) !== -1 ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif ( undefined === termTree.children ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst anyChildIsSelected =\n\t\t\t\ttermTree.children\n\t\t\t\t.map( treeHasSelection )\n\t\t\t\t.filter( ( child ) => child ).length > 0;\n\t\t\tif ( anyChildIsSelected ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tconst termOrChildIsSelected = ( termA, termB ) => {\n\t\t\tconst termASelected = treeHasSelection( termA );\n\t\t\tconst termBSelected = treeHasSelection( termB );\n\n\t\t\tif ( termASelected === termBSelected ) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tif ( termASelected && ! termBSelected ) {\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\tif ( ! termASelected && termBSelected ) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t};\n\t\ttermsTree.sort( termOrChildIsSelected );\n\t\treturn termsTree;\n\t}\n\n\tsetFilterValue( event ) {\n\t\tconst { availableTermsTree } = this.state;\n\t\tconst filterValue = event.target.value;\n\t\tconst filteredTermsTree = availableTermsTree\n\t\t.map( this.getFilterMatcher( filterValue ) )\n\t\t.filter( ( term ) => term );\n\t\tconst getResultCount = ( terms ) => {\n\t\t\tlet count = 0;\n\t\t\tfor ( let i = 0; i < terms.length; i++ ) {\n\t\t\t\tcount++;\n\t\t\t\tif ( undefined !== terms[ i ].children ) {\n\t\t\t\t\tcount += getResultCount( terms[ i ].children );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn count;\n\t\t};\n\t\tthis.setState( {\n\t\t\tfilterValue,\n\t\t\tfilteredTermsTree,\n\t\t} );\n\n\t\tconst resultCount = getResultCount( filteredTermsTree );\n\t\tconst resultsFoundMessage = sprintf(\n\t\t\t/* translators: %d: number of results */\n\t\t\t_n( '%d result found.', '%d results found.', resultCount ),\n\t\t\tresultCount\n\t\t);\n\t\tthis.props.debouncedSpeak( resultsFoundMessage, 'assertive' );\n\t}\n\n\tgetFilterMatcher( filterValue ) {\n\t\tconst matchTermsForFilter = ( originalTerm ) => {\n\t\t\tif ( '' === filterValue ) {\n\t\t\t\treturn originalTerm;\n\t\t\t}\n\n\t\t\t// Shallow clone, because we'll be filtering the term's children and\n\t\t\t// don't want to modify the original term.\n\t\t\tconst term = { ...originalTerm };\n\n\t\t\t// Map and filter the children, recursive so we deal with grandchildren\n\t\t\t// and any deeper levels.\n\t\t\tif ( term.children.length > 0 ) {\n\t\t\t\tterm.children = term.children\n\t\t\t\t.map( matchTermsForFilter )\n\t\t\t\t.filter( ( child ) => child );\n\t\t\t}\n\n\t\t\t// If the term's name contains the filterValue, or it has children\n\t\t\t// (i.e. some child matched at some point in the tree) then return it.\n\t\t\tif (\n\t\t\t\t-1 !==\n\t\t\t\tterm.name\n\t\t\t\t.toLowerCase()\n\t\t\t\t.indexOf( filterValue.toLowerCase() ) ||\n\t\t\t\tterm.children.length > 0\n\t\t\t) {\n\t\t\t\treturn term;\n\t\t\t}\n\n\t\t\t// Otherwise, return false. After mapping, the list of terms will need\n\t\t\t// to have false values filtered out.\n\t\t\treturn false;\n\t\t};\n\t\treturn matchTermsForFilter;\n\t}\n\n\t/**\n\t * Extends the original renderTerms on HierarchicalTermSelector\n\t * by adding in logic for the primary category selector\n\t * @param renderedTerms\n\t * @returns {*}\n\t */\n\trenderTerms( renderedTerms ) {\n\t\tconst { terms = [], activeCssClass } = this.props;\n\t\treturn renderedTerms.map( ( term ) => {\n\t\t\tconst controlID = `editor-post-taxonomies-hierarchical-term-${ term.id }`;\n\t\t\treturn (\n\t\t\t\t<div\n\t\t\t\t\tkey={ term.id }\n\t\t\t\t\tclassName='editor-post-taxonomies__hierarchical-terms-choice'\n\t\t\t\t>\n\t\t\t\t\t<CheckboxControl\n\t\t\t\t\t\tchecked={ terms.indexOf( term.id ) !== -1 }\n\t\t\t\t\t\tonChange={ () => {\n\t\t\t\t\t\t\tconst termId = parseInt( term.id, 10 );\n\t\t\t\t\t\t\tthis.onChange( termId );\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t\t<label\n\t\t\t\t\t\tclassName={[\n\t\t\t\t\t\t\tthis.isPrimary(term.id) ? activeCssClass : ''\n\t\t\t\t\t\t]}\n\t\t\t\t\t\thtmlFor={ controlID }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ unescapeString(term.name) }\n\t\t\t\t\t</label>\n\t\t\t\t\t<span\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tthis.togglePrimary(term.id);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclassName={CWPC_Core.slug}>\n\t\t\t\t\t\t\t\t\t{ this.isPrimary(term.id)\n\t\t\t\t\t\t\t\t\t\t? 'Remove Primary'\n\t\t\t\t\t\t\t\t\t\t: <span className='dashicons dashicons-star-empty' title='Set as Primary'>&nbsp;</span>\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t</span>\n\t\t\t\t\t{ !! term.children.length && (\n\t\t\t\t\t\t<div className='editor-post-taxonomies__hierarchical-terms-subchoices'>\n\t\t\t\t\t\t\t{ this.renderTerms( term.children ) }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t);\n\t\t} );\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tslug,\n\t\t\ttaxonomy,\n\t\t\tterms, // @helegatheviking\n\t\t\tinstanceId,\n\t\t\thasCreateAction,\n\t\t\thasAssignAction,\n\t\t} = this.props;\n\n\t\tconst klass = taxonomy.hierarchical ? 'hierarchical' : 'non-hierarchical'; // @helgatheviking\n\n\t\tif ( ! hasAssignAction ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst {\n\t\t\tavailableTermsTree,\n\t\t\tavailableTerms,\n\t\t\tfilteredTermsTree,\n\t\t\tformName,\n\t\t\tformParent,\n\t\t\tloading,\n\t\t\tshowForm,\n\t\t\tfilterValue,\n\t\t} = this.state;\n\t\tconst labelWithFallback = (\n\t\t\tlabelProperty,\n\t\t\tfallbackIsCategory,\n\t\t\tfallbackIsNotCategory\n\t\t) =>\n\t\t\tget(\n\t\t\t\ttaxonomy,\n\t\t\t\t[ 'labels', labelProperty ],\n\t\t\t\tslug === 'category' ? fallbackIsCategory : fallbackIsNotCategory\n\t\t\t);\n\t\tconst newTermButtonLabel = labelWithFallback(\n\t\t\t'add_new_item',\n\t\t\t__( 'Add new category' ),\n\t\t\t__( 'Add new term' )\n\t\t);\n\t\tconst newTermLabel = labelWithFallback(\n\t\t\t'new_item_name',\n\t\t\t__( 'Add new category' ),\n\t\t\t__( 'Add new term' )\n\t\t);\n\t\tconst parentSelectLabel = labelWithFallback(\n\t\t\t'parent_item',\n\t\t\t__( 'Parent Category' ),\n\t\t\t__( 'Parent Term' )\n\t\t);\n\t\tconst noParentOption = `— ${ parentSelectLabel } —`;\n\t\tconst newTermSubmitLabel = newTermButtonLabel;\n\t\tconst inputId = `editor-post-taxonomies__${ klass }-terms-input-${ instanceId }`; // @helgatheviking\n\t\tconst filterInputId = `editor-post-taxonomies__${ klass }-terms-filter-${ instanceId }`; // @helgatheviking\n\t\tconst filterLabel = get(\n\t\t\tthis.props.taxonomy,\n\t\t\t[ 'labels', 'search_items' ],\n\t\t\t__( 'Search Terms' )\n\t\t);\n\t\tconst groupLabel = get(\n\t\t\tthis.props.taxonomy,\n\t\t\t[ 'name' ],\n\t\t\t__( 'Terms' )\n\t\t);\n\t\tconst showFilter = availableTerms.length >= MIN_TERMS_COUNT_FOR_FILTER;\n\n\t\tconst noneSelected = terms.length ? 0 : -1; // @helgatheviking\n\t\tconst noneLabel = sprintf( // @helgatheviking\n\t\t\t/* translators: %s: taxonomy name */\n\t\t\t_x( 'No %s', 'term', 'radio-buttons-for-taxonomies' ),\n\t\t\tget(\n\t\t\t\tthis.props.taxonomy,\n\t\t\t\t[ 'labels', 'singular_name' ],\n\t\t\t\tslug === 'category' ? __( 'Category' ) : __( 'Term' )\n\t\t\t)\n\t\t);\n\n\t\treturn [\n\t\t\tshowFilter && (\n\t\t\t\t<label key='filter-label' htmlFor={ filterInputId }>\n\t\t\t\t\t{ filterLabel }\n\t\t\t\t</label>\n\t\t\t),\n\t\t\tshowFilter && (\n\t\t\t\t<input\n\t\t\t\t\ttype='search'\n\t\t\t\t\tid={ filterInputId }\n\t\t\t\t\tvalue={ filterValue }\n\t\t\t\t\tonChange={ this.setFilterValue }\n\t\t\t\t\tclassName='editor-post-taxonomies__hierarchical-terms-filter'\n\t\t\t\t\tkey='term-filter-input'\n\t\t\t\t/>\n\t\t\t),\n\t\t\t<div\n\t\t\t\tclassName='editor-post-taxonomies__hierarchical-terms-list'\n\t\t\t\tkey='term-list'\n\t\t\t\ttabIndex='0'\n\t\t\t\trole='group'\n\t\t\t\taria-label={ groupLabel }\n\t\t\t>\n\t\t\t\t{ this.renderTerms( '' !== filterValue ? filteredTermsTree : availableTermsTree ) }\n\n\t\t\t\t{ taxonomy.radio_no_term && (\n\t\t\t\t\t<div key='no-term' className={ 'editor-post-taxonomies__' + klass + '-terms-choice ' }>\n\t\t\t\t\t\t<RadioControl\n\t\t\t\t\t\t\tselected={ noneSelected }\n\t\t\t\t\t\t\toptions={ [\n\t\t\t\t\t\t\t\t{ label: noneLabel, value: -1 },\n\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t\tonChange={ () => {\n\t\t\t\t\t\t\t\tthis.onClear();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t) }\n\n\t\t\t</div>,\n\t\t\t! loading && hasCreateAction && (\n\t\t\t\t<Button\n\t\t\t\t\tkey='term-add-button'\n\t\t\t\t\tonClick={ this.onToggleForm }\n\t\t\t\t\tclassName='editor-post-taxonomies__hierarchical-terms-add'\n\t\t\t\t\taria-expanded={ showForm }\n\t\t\t\t\tisLink\n\t\t\t\t>\n\t\t\t\t\t{ newTermButtonLabel }\n\t\t\t\t</Button>\n\t\t\t),\n\t\t\tshowForm && (\n\t\t\t\t<form onSubmit={ this.onAddTerm } key={ klass + '-terms-form' }>\n\t\t\t\t\t<label\n\t\t\t\t\t\thtmlFor={ inputId }\n\t\t\t\t\t\tclassName='editor-post-taxonomies__hierarchical-terms-label'\n\t\t\t\t\t>\n\t\t\t\t\t\t{ newTermLabel }\n\t\t\t\t\t</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\tid={ inputId }\n\t\t\t\t\t\tclassName='editor-post-taxonomies__hierarchical-terms-input'\n\t\t\t\t\t\tvalue={ formName }\n\t\t\t\t\t\tonChange={ this.onChangeFormName }\n\t\t\t\t\t\trequired\n\t\t\t\t\t/>\n\t\t\t\t\t{ taxonomy.hierarchical && !! availableTerms.length && // @helgatheviking\n\t\t\t\t\t<TreeSelect\n\t\t\t\t\t\tlabel={ parentSelectLabel }\n\t\t\t\t\t\tnoOptionLabel={ noParentOption }\n\t\t\t\t\t\tonChange={ this.onChangeFormParent }\n\t\t\t\t\t\tselectedId={ formParent }\n\t\t\t\t\t\ttree={ availableTermsTree }\n\t\t\t\t\t/>\n\t\t\t\t\t}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tisSecondary\n\t\t\t\t\t\ttype='submit'\n\t\t\t\t\t\tclassName='editor-post-taxonomies__hierarchical-terms-submit'\n\t\t\t\t\t>\n\t\t\t\t\t\t{ newTermSubmitLabel }\n\t\t\t\t\t</Button>\n\t\t\t\t</form>\n\t\t\t),\n\t\t];\n\t}\n\n\t/**\n\t * Checks if the supplied termID is the primary term\n\t * @param termID\n\t * @returns {boolean}\n\t */\n\tisPrimary(termID){\n\t\tlet current = wp.data.select('core/editor').getEditedPostAttribute('meta')[CWPC_Core.metaKey];\n\t\tcurrent = current || '';\n\t\treturn current.toString() === termID.toString();\n\t}\n\n\t/**\n\t * Toggles the primary category with the supplied one\n\t * @param termID\n\t */\n\ttogglePrimary(termID){\n\t\tconst { onUpdateTerms, terms, togglePrimaryDispatch, taxonomy } = this.props;\n\t\ttogglePrimaryDispatch(termID);\n\t\tonUpdateTerms( [ ...terms, termID ], taxonomy.rest_base )\n\t}\n\n\t/**\n\t * Places the primary category (if any) at the top of the list\n\t *\n\t * @param terms\n\t * @returns {*[]|*}\n\t */\n\tprioritize( terms ) {\n\t\tconst primaryFound = terms.find( term => {\n\t\t\treturn this.isPrimary(term.id);\n\t\t});\n\n\t\tif (!primaryFound) {\n\t\t\treturn terms;\n\t\t}\n\n\t\tconst nonPrimary = terms.filter(term => !this.isPrimary(term.id));\n\t\treturn [ primaryFound, ...nonPrimary];\n\t}\n}\n\nexport default compose([\n\twithSelect( ( select, { slug } ) => {\n\t\tconst { getCurrentPost } = select( 'core/editor' );\n\t\tconst { getTaxonomy } = select( 'core' );\n\t\tconst taxonomy = getTaxonomy( slug );\n\t\treturn {\n\t\t\thasCreateAction: taxonomy\n\t\t\t\t? get(\n\t\t\t\t\tgetCurrentPost(),\n\t\t\t\t\t[ '_links', 'wp:action-create-' + taxonomy.rest_base ],\n\t\t\t\t\tfalse\n\t\t\t\t)\n\t\t\t\t: false,\n\t\t\thasAssignAction: taxonomy\n\t\t\t\t? get(\n\t\t\t\t\tgetCurrentPost(),\n\t\t\t\t\t[ '_links', 'wp:action-assign-' + taxonomy.rest_base ],\n\t\t\t\t\tfalse\n\t\t\t\t)\n\t\t\t\t: false,\n\t\t\tterms: taxonomy\n\t\t\t\t? select( 'core/editor' ).getEditedPostAttribute(\n\t\t\t\t\ttaxonomy.rest_base\n\t\t\t\t)\n\t\t\t\t: [],\n\t\t\ttaxonomy,\n\t\t\tactiveCssClass: 'cwpc_active',\n\t\t\tslug: 'cwpc',\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => ({\n\t\tonUpdateTerms( terms, restBase ) {\n\t\t\tdispatch( 'core/editor' ).editPost( { [ restBase ]: terms } );\n\t\t},\n\t\tisPrimary(termID){\n\t\t\tlet current = wp.data.select('core/editor').getEditedPostAttribute('meta')[CWPC_Core.metaKey];\n\t\t\tcurrent = current ? current.toString() : '';\n\t\t\treturn current === termID.toString();\n\t\t},\n\t\t/**\n\t\t * Returns true if the supplied has been made primary\n\t\t * @param termID\n\t\t * @returns {boolean}\n\t\t */\n\t\ttogglePrimaryDispatch(termID){\n\t\t\tconst current = wp.data.select('core/editor').getEditedPostAttribute('meta')[CWPC_Core.metaKey];\n\t\t\tconst newValue = +current === termID ? '' : termID;\n\t\t\tdispatch( 'core/editor' ).editPost({\n\t\t\t\tmeta: {\n\t\t\t\t\t[CWPC_Core.metaKey]: newValue.toString()\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn newValue !== '';\n\t\t}\n\t} ) ),\n\twithSpokenMessages,\n\twithInstanceId,\n] )( CWPCHierarchicalTermSelector );\n","import CWPCHierarchicalTermSelector from './cwpc-hierarchical-term-selector'\nimport { CWPC_Core } from './editor_block_data';\n\nconst cwpcHierarchicalTermSelectorOverride = ( OriginalComponent ) => {\n\treturn ( props ) => {\n\n\t\tif ( props.slug === CWPC_Core.targetTaxonomy ) {\n\t\t\treturn <CWPCHierarchicalTermSelector {...props} />\n\t\t}\n\n\t\treturn <OriginalComponent {...props} />\n\t};\n}\n\nwp.hooks.addFilter( 'editor.PostTaxonomyType', CWPC_Core.slug, cwpcHierarchicalTermSelectorOverride );\n","export const CWPC_Core = {\n\ttargetTaxonomy: 'category',\n\tslug: 'cwpc',\n\tmetaKey: '_cwpc'\n};\n","/**\n * External dependencies\n */\nimport { groupBy } from 'lodash';\n\n/**\n * Returns terms in a tree form.\n *\n * @param {Array} flatTerms  Array of terms in flat format.\n *\n * @return {Array} Array of terms in tree format.\n */\nexport function buildTermsTree( flatTerms ) {\n\tconst flatTermsWithParentAndChildren = flatTerms.map( ( term ) => {\n\t\treturn {\n\t\t\tchildren: [],\n\t\t\tparent: null,\n\t\t\t...term,\n\t\t};\n\t} );\n\n\tconst termsByParent = groupBy( flatTermsWithParentAndChildren, 'parent' );\n\tif ( termsByParent.null && termsByParent.null.length ) {\n\t\treturn flatTermsWithParentAndChildren;\n\t}\n\tconst fillWithChildren = ( terms ) => {\n\t\treturn terms.map( ( term ) => {\n\t\t\tconst children = termsByParent[ term.id ];\n\t\t\treturn {\n\t\t\t\t...term,\n\t\t\t\tchildren: children && children.length ?\n\t\t\t\t\tfillWithChildren( children ) :\n\t\t\t\t\t[],\n\t\t\t};\n\t\t} );\n\t};\n\n\treturn fillWithChildren( termsByParent[ '0' ] || [] );\n}\n","(function() { module.exports = window[\"wp\"][\"apiFetch\"]; }());","(function() { module.exports = window[\"wp\"][\"components\"]; }());","(function() { module.exports = window[\"wp\"][\"compose\"]; }());","(function() { module.exports = window[\"wp\"][\"data\"]; }());","(function() { module.exports = window[\"wp\"][\"element\"]; }());","(function() { module.exports = window[\"wp\"][\"i18n\"]; }());","(function() { module.exports = window[\"wp\"][\"url\"]; }());","(function() { module.exports = window[\"lodash\"]; }());"],"sourceRoot":""}